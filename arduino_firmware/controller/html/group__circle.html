<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Autonomous Robot Navigation Firmware: Circle Tracking</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Autonomous Robot Navigation Firmware<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">Firmware for an autonomous robot navigation system. Developed by Odyssey for the 2024 QUT Droid Racing Challenge.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">Circle Tracking</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga52e701921c6af10a81e39ff26ea7ef35" id="r_ga52e701921c6af10a81e39ff26ea7ef35"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structvec.html">vec</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga52e701921c6af10a81e39ff26ea7ef35">circle_track</a> (<a class="el" href="structvec.html">vec</a> s, <a class="el" href="structvec.html">vec</a> t, <a class="el" href="structvec.html">vec</a> h, float vel)</td></tr>
<tr class="memdesc:ga52e701921c6af10a81e39ff26ea7ef35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates motor speeds for tracking a circular path towards a target point.This function computes the speeds for the left and right motors of a vehicle to make it follow a circular path towards a target point. It uses the current position (s), target position (t), and heading vector (h) to determine the direction and magnitude of the required turn. The function calculates the distance to the target and uses it along with the desired velocity (vel) to compute the appropriate motor speeds. If the target is within a small tolerance, it stops the motors. Otherwise, it determines whether to turn left or right based on the cross product of the heading and the direction to the target. It then calculates the turning radius and adjusts the motor speeds accordingly to achieve the desired circular path. The function ensures that the vehicle turns in the most efficient manner to reach the target point.  <br /></td></tr>
<tr class="separator:ga52e701921c6af10a81e39ff26ea7ef35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3bacc59d508af5172ad7ca0ed81dcde8" id="r_ga3bacc59d508af5172ad7ca0ed81dcde8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3bacc59d508af5172ad7ca0ed81dcde8">sendVecs</a> ()</td></tr>
<tr class="memdesc:ga3bacc59d508af5172ad7ca0ed81dcde8"><td class="mdescLeft">&#160;</td><td class="mdescRight">sends the current position, target position, and target velocity to the serial monitor.  <br /></td></tr>
<tr class="separator:ga3bacc59d508af5172ad7ca0ed81dcde8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga711de31e5f23c9bce1a990ecb3b87ece" id="r_ga711de31e5f23c9bce1a990ecb3b87ece"><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga711de31e5f23c9bce1a990ecb3b87ece">dtCircle</a></td></tr>
<tr class="memdesc:ga711de31e5f23c9bce1a990ecb3b87ece"><td class="mdescLeft">&#160;</td><td class="mdescRight">time difference for circle tracking  <br /></td></tr>
<tr class="separator:ga711de31e5f23c9bce1a990ecb3b87ece"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga528e2b4ef79df24e1dd08edef61b9287" id="r_ga528e2b4ef79df24e1dd08edef61b9287"><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga528e2b4ef79df24e1dd08edef61b9287">prevCircleTime</a> = 0</td></tr>
<tr class="memdesc:ga528e2b4ef79df24e1dd08edef61b9287"><td class="mdescLeft">&#160;</td><td class="mdescRight">previous time for circle tracking  <br /></td></tr>
<tr class="separator:ga528e2b4ef79df24e1dd08edef61b9287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7f06888a20c73a79e7aaa81363378845" id="r_ga7f06888a20c73a79e7aaa81363378845"><td class="memItemLeft" align="right" valign="top">const long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7f06888a20c73a79e7aaa81363378845">CIRCLE_TIME</a> = 500000</td></tr>
<tr class="memdesc:ga7f06888a20c73a79e7aaa81363378845"><td class="mdescLeft">&#160;</td><td class="mdescRight">μs | Circle tracking update time  <br /></td></tr>
<tr class="separator:ga7f06888a20c73a79e7aaa81363378845"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5318d915170220fe788572be250a5dd8" id="r_ga5318d915170220fe788572be250a5dd8"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga5318d915170220fe788572be250a5dd8">CIRCLE_LOOPS</a> = <a class="el" href="#ga7f06888a20c73a79e7aaa81363378845">CIRCLE_TIME</a>/<a class="el" href="group___p_i_d.html#gaeb53e5d7ad15d22a3219183cfd59fdf1">PID_TIME</a></td></tr>
<tr class="memdesc:ga5318d915170220fe788572be250a5dd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of loops for circle tracking  <br /></td></tr>
<tr class="separator:ga5318d915170220fe788572be250a5dd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeee616ef0b97f334f47ae26c2bde5c4d" id="r_gaeee616ef0b97f334f47ae26c2bde5c4d"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaeee616ef0b97f334f47ae26c2bde5c4d">AVERAGE_TARGET_VELOCITY</a> = 0.5</td></tr>
<tr class="memdesc:gaeee616ef0b97f334f47ae26c2bde5c4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">m/s | average target velocity for circle tracking  <br /></td></tr>
<tr class="separator:gaeee616ef0b97f334f47ae26c2bde5c4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae28621c15a1e8e4d814cfd499ea3b12b" id="r_gae28621c15a1e8e4d814cfd499ea3b12b"><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae28621c15a1e8e4d814cfd499ea3b12b">loop_no</a> = 0</td></tr>
<tr class="memdesc:gae28621c15a1e8e4d814cfd499ea3b12b"><td class="mdescLeft">&#160;</td><td class="mdescRight">loop number for circle tracking  <br /></td></tr>
<tr class="separator:gae28621c15a1e8e4d814cfd499ea3b12b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad7827216a39d669d61224bc94d771478" id="r_gad7827216a39d669d61224bc94d771478"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad7827216a39d669d61224bc94d771478">des_L</a> = 0</td></tr>
<tr class="memdesc:gad7827216a39d669d61224bc94d771478"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculated desired left speed  <br /></td></tr>
<tr class="separator:gad7827216a39d669d61224bc94d771478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8aef7eca2f3ef952b93eea3cc4b75e91" id="r_ga8aef7eca2f3ef952b93eea3cc4b75e91"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8aef7eca2f3ef952b93eea3cc4b75e91">des_R</a> = 0</td></tr>
<tr class="memdesc:ga8aef7eca2f3ef952b93eea3cc4b75e91"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculated desired right speed  <br /></td></tr>
<tr class="separator:ga8aef7eca2f3ef952b93eea3cc4b75e91"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga52e701921c6af10a81e39ff26ea7ef35" name="ga52e701921c6af10a81e39ff26ea7ef35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga52e701921c6af10a81e39ff26ea7ef35">&#9670;&#160;</a></span>circle_track()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structvec.html">vec</a> circle_track </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvec.html">vec</a></td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvec.html">vec</a></td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvec.html">vec</a></td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>vel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates motor speeds for tracking a circular path towards a target point.This function computes the speeds for the left and right motors of a vehicle to make it follow a circular path towards a target point. It uses the current position (s), target position (t), and heading vector (h) to determine the direction and magnitude of the required turn. The function calculates the distance to the target and uses it along with the desired velocity (vel) to compute the appropriate motor speeds. If the target is within a small tolerance, it stops the motors. Otherwise, it determines whether to turn left or right based on the cross product of the heading and the direction to the target. It then calculates the turning radius and adjusts the motor speeds accordingly to achieve the desired circular path. The function ensures that the vehicle turns in the most efficient manner to reach the target point. </p>
<dl class="section note"><dt>Note</dt><dd>This function uses the <code>HALF_VEHICLE_WIDTH</code> constant to determine the turning radius based on the vehicle's dimensions.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The current position of the vehicle as a vector. </td></tr>
    <tr><td class="paramname">t</td><td>The target position as a vector. </td></tr>
    <tr><td class="paramname">h</td><td>The current heading of the vehicle as a vector. </td></tr>
    <tr><td class="paramname">vel</td><td>The desired velocity towards the target. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector representing the speeds for the left (x component) and right (y component) motors. </dd></dl>

</div>
</div>
<a id="ga3bacc59d508af5172ad7ca0ed81dcde8" name="ga3bacc59d508af5172ad7ca0ed81dcde8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3bacc59d508af5172ad7ca0ed81dcde8">&#9670;&#160;</a></span>sendVecs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sendVecs </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sends the current position, target position, and target velocity to the serial monitor. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="gaeee616ef0b97f334f47ae26c2bde5c4d" name="gaeee616ef0b97f334f47ae26c2bde5c4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeee616ef0b97f334f47ae26c2bde5c4d">&#9670;&#160;</a></span>AVERAGE_TARGET_VELOCITY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float AVERAGE_TARGET_VELOCITY = 0.5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>m/s | average target velocity for circle tracking </p>

</div>
</div>
<a id="ga5318d915170220fe788572be250a5dd8" name="ga5318d915170220fe788572be250a5dd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5318d915170220fe788572be250a5dd8">&#9670;&#160;</a></span>CIRCLE_LOOPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int CIRCLE_LOOPS = <a class="el" href="#ga7f06888a20c73a79e7aaa81363378845">CIRCLE_TIME</a>/<a class="el" href="group___p_i_d.html#gaeb53e5d7ad15d22a3219183cfd59fdf1">PID_TIME</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>number of loops for circle tracking </p>

</div>
</div>
<a id="ga7f06888a20c73a79e7aaa81363378845" name="ga7f06888a20c73a79e7aaa81363378845"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7f06888a20c73a79e7aaa81363378845">&#9670;&#160;</a></span>CIRCLE_TIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const long int CIRCLE_TIME = 500000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>μs | Circle tracking update time </p>

</div>
</div>
<a id="gad7827216a39d669d61224bc94d771478" name="gad7827216a39d669d61224bc94d771478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad7827216a39d669d61224bc94d771478">&#9670;&#160;</a></span>des_L</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int des_L = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculated desired left speed </p>

</div>
</div>
<a id="ga8aef7eca2f3ef952b93eea3cc4b75e91" name="ga8aef7eca2f3ef952b93eea3cc4b75e91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8aef7eca2f3ef952b93eea3cc4b75e91">&#9670;&#160;</a></span>des_R</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int des_R = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculated desired right speed </p>

</div>
</div>
<a id="ga711de31e5f23c9bce1a990ecb3b87ece" name="ga711de31e5f23c9bce1a990ecb3b87ece"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga711de31e5f23c9bce1a990ecb3b87ece">&#9670;&#160;</a></span>dtCircle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int dtCircle</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>time difference for circle tracking </p>

</div>
</div>
<a id="gae28621c15a1e8e4d814cfd499ea3b12b" name="gae28621c15a1e8e4d814cfd499ea3b12b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae28621c15a1e8e4d814cfd499ea3b12b">&#9670;&#160;</a></span>loop_no</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int loop_no = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>loop number for circle tracking </p>

</div>
</div>
<a id="ga528e2b4ef79df24e1dd08edef61b9287" name="ga528e2b4ef79df24e1dd08edef61b9287"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga528e2b4ef79df24e1dd08edef61b9287">&#9670;&#160;</a></span>prevCircleTime</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int prevCircleTime = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>previous time for circle tracking </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
