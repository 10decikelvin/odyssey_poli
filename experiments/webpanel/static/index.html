<div id="joyDiv1" style="width: 100px; height: 100px; margin: 0;"></div>
<script src = "static/joystick.js"></script>
<script>
    let joystickContainer = document.querySelector("#joyDiv1")
    joystickContainer.style.height = joystickContainer.style.width = Math.min(innerHeight, innerWidth);
    
    let webSocket = new WebSocket("ws://192.168.137.142:8080");

    let lastLeft = 0;
    let lastRight = 0;
    let left = 0;
    let right = 0;
    setInterval(() => {
        if(left === lastLeft && right === lastRight){
            return;
        }
        lastLeft = left;
        lastRight = right;
        webSocket.send(JSON.stringify({left, right}));
    }, 100)
    let joy = new JoyStick('joyDiv1', {}, ({x, y}) => {
        absX = Math.abs(x);
        absY = Math.abs(y);
        if(x >= 0 && y >= 0){
            left = absY;
            right = absY - absX;
        }else if(x < 0 && y >= 0){
            right = absY;
            left = absY - absX;
        }else if(x >= 0 && y < 0){
            right = -absY;
            left = -(absY-absX);
        }else if(x < 0 && y < 0){
            left = -absY;
            right = -(absY-absX);
        }
        left /= 100;
        right /= 100;
        left = Math.min(1, Math.max(-1, left));
        right = Math.min(1, Math.max(-1, right));
    });
    webSocket.onopen = (event) => {
        console.log("open")
    };
</script>